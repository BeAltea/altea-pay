# ==============================================
# Altea Pay - Environment Variables
# ==============================================

# Application
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ==============================================
# Supabase Configuration
# ==============================================
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
SUPABASE_JWT_SECRET=your_jwt_secret

# ==============================================
# ASAAS Payment Gateway
# ==============================================
# Production: https://api.asaas.com/v3
# Sandbox: https://api-sandbox.asaas.com/v3
ASAAS_API_URL=https://api.asaas.com/v3

# API Key from ASAAS Dashboard -> Menu -> Integrações -> API
# IMPORTANT: If your key starts with $ (e.g., $aact_prod_...), escape it with backslash:
# ASAAS_API_KEY=\$aact_prod_xxx::yyy::\$aach_zzz
ASAAS_API_KEY=your_asaas_api_key

# Webhook Token for validating incoming webhook requests
# Generate a secure random string (e.g., openssl rand -hex 32)
# Configure this same token in ASAAS Dashboard -> Webhooks -> Access Token
ASAAS_WEBHOOK_TOKEN=your_secure_webhook_token

# ==============================================
# Assertiva Credit Analysis
# ==============================================
ASSERTIVA_BASE_URL=https://api.assertivasolucoes.com.br
ASSERTIVA_CLIENT_ID=your_assertiva_client_id
ASSERTIVA_CLIENT_SECRET=your_assertiva_client_secret
ASSERTIVA_CALLBACK_URL=https://your-domain.com/api/assertiva/callback

# ==============================================
# Twilio SMS/WhatsApp
# ==============================================
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_MESSAGING_SERVICE_SID=your_messaging_service_sid
TWILIO_PHONE_NUMBER=+1234567890

# ==============================================
# Email Services
# ==============================================
RESEND_API_KEY=your_resend_api_key

# SendGrid (alternative)
SENDGRID_API_KEY=your_sendgrid_api_key
SENDGRID_FROM_EMAIL=noreply@alteapay.com
SENDGRID_FROM_NAME=AlteaPay
SENDGRID_REPLY_TO=support@alteapay.com

# ==============================================
# Redis / BullMQ Queue System
# ==============================================
# Local development (Docker):
REDIS_URL=redis://localhost:6379

# Production (Upstash Redis):
# UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
# UPSTASH_REDIS_REST_TOKEN=your_upstash_token

# ==============================================
# Cron Jobs
# ==============================================
# Secret token for authenticating cron job requests
CRON_SECRET=your_cron_secret

# ==============================================
# ASAAS Webhook Configuration Guide
# ==============================================
#
# 1. Go to ASAAS Dashboard -> Menu do Usuário -> Integrações -> Webhooks
#
# 2. Create a new webhook with:
#    - URL: https://your-domain.com/api/asaas/webhook/payments
#    - OR (legacy): https://your-domain.com/api/webhooks/asaas
#
# 3. Select events to receive:
#    - PAYMENT_CREATED
#    - PAYMENT_AWAITING_RISK_ANALYSIS
#    - PAYMENT_PENDING
#    - PAYMENT_CONFIRMED
#    - PAYMENT_RECEIVED
#    - PAYMENT_OVERDUE
#    - PAYMENT_DELETED
#    - PAYMENT_REFUNDED
#    - PAYMENT_REFUND_REQUESTED
#    - PAYMENT_UPDATED
#    - PAYMENT_CREDIT_CARD_CAPTURE_REFUSED
#    - PAYMENT_DUNNING_RECEIVED
#    - PAYMENT_DUNNING_REQUESTED
#
# 4. Set Access Token to the same value as ASAAS_WEBHOOK_TOKEN above
#
# 5. Test the webhook using ASAAS sandbox environment
#
# Note: The webhook handler will:
#    - Validate the token from request headers
#    - Log all events to asaas_webhook_events table
#    - Deduplicate repeated events
#    - Update agreement status, payment status, and debt status
#    - Create notifications for customers
#
# ==============================================
